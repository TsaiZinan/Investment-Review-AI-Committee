---
name: "investment-analyzer"
description: "触发语：每日分析 / 开始单AI分析。执行基金+黄金组合定投分析，生成当日投资建议报告。"
---

# 投资分析器

当用户输入“每日分析”（或表达要开始单 AI 投资分析）时，执行本技能。

本技能基于 `1每日单AI投资分析prompt.md` 的流程，生成标准化产物到 `报告/YYYY-MM-DD/`。

## 功能

1. 读取并解析投资策略文件（JSON格式）
2. 创建日期文件夹结构
3. 生成投资简报
4. 执行联网数据搜集
5. 生成投资建议报告
6. 执行最终校验与清理

## 执行流程

严格按照以下步骤执行：

### 步骤0：确认模型名
- 向用户提问：`🤔本次使用的“模型名”字符串是什么？`
- 提供备选列表供用户参考：`DeepSeek, Gemini, GPT-5.2, Grok-4, GLM-4.7, Kimi, MiniMax-M2.1, TraeAI`
- 必须等待用户回复后才能继续
- 允许用户在同一句里补充：日期（YYYY-MM-DD）、定投检视周期、风险偏好；未提供则使用最合理默认值（日期=今天，周期=每月，风险偏好=稳健）

### 步骤1：检查/创建日期文件夹
- 日期格式：`YYYY-MM-DD`
- 创建路径：`报告/{YYYY-MM-DD}/`
- 创建子文件夹：`进度/`、`简报/`

### 步骤2：生成/复用投资策略.json
- 检查是否存在：`报告/{YYYY-MM-DD}/投资策略.json`
- 如不存在，从 `Data/投资策略.xlsx` 转换生成
- 优先用命令生成（会同时生成/复用简报与进度文件）：
  - `python scripts/run_workflow_part1.py --model "{模型名}" --date "{YYYY-MM-DD}" --fetch`
  - `--fetch` 必须启用：即使 `报告/{YYYY-MM-DD}/market_data.json` 已存在，也要联网重新拉取并覆盖更新

### 步骤3：生成投资简报
- 读取投资策略.json
- 生成：`报告/{YYYY-MM-DD}/简报/投资简报_{模型名}.md`

### 步骤4：执行定投计划建议分析
- 严格按 `1每日单AI投资分析prompt.md` 的“输出结构”生成内容
- 保存文件（必须）：
  - `报告/{YYYY-MM-DD}/{YYYY-MM-DD}_{模型名}_投资建议.md`

### 步骤5：最终校验与清理
- 校验文件命名
- 校验基金标的覆盖
- 校验联网数据时间为本次日期（`market_data.json.fetched_at == YYYY-MM-DD`）
- 清理临时文件
- 优先用命令做命名+覆盖校验，并把结果写入校验报告：
  - `python scripts/run_workflow_part1.py --model "{模型名}" --date "{YYYY-MM-DD}" --validate`

## 进度跟踪

必须创建并更新进度文件：`报告/{YYYY-MM-DD}/进度/进度_{模型名}.md`

## 输出要求

1. 严格按照Markdown结构输出
2. 控制总长度，尽量不超过2屏
3. 每个结论只给1-2条关键证据
4. 定投增减理由不超过20字
5. 建议最多5条
